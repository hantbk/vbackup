(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6e0e311e"],{"3ffe":function(e,t,o){"use strict";o.d(t,"g",(function(){return a})),o.d(t,"e",(function(){return n})),o.d(t,"c",(function(){return s})),o.d(t,"b",(function(){return i})),o.d(t,"q",(function(){return c})),o.d(t,"o",(function(){return l})),o.d(t,"h",(function(){return d})),o.d(t,"n",(function(){return u})),o.d(t,"j",(function(){return p})),o.d(t,"k",(function(){return m})),o.d(t,"a",(function(){return f})),o.d(t,"m",(function(){return b})),o.d(t,"l",(function(){return h})),o.d(t,"i",(function(){return y})),o.d(t,"d",(function(){return g})),o.d(t,"p",(function(){return k})),o.d(t,"f",(function(){return w}));o("99af");var r=o("b775");function a(e){return Object(r["a"])({url:"/repository",method:"get",params:e})}function n(e){return Object(r["a"])({url:"/repository/".concat(e),method:"get"})}function s(e){return Object(r["a"])({url:"/repository/".concat(e),method:"delete"})}function i(e){return Object(r["a"])({url:"/repository",method:"post",data:e})}function c(e){return Object(r["a"])({url:"/repository/".concat(e.id),method:"put",data:e})}function l(e){return Object(r["a"])({url:"/restic/".concat(e.id,"/snapshots"),method:"get",params:e})}function d(e,t,o){return Object(r["a"])({url:"/restic/".concat(e,"/ls/").concat(t),method:"get",params:o})}function u(e,t,o){return Object(r["a"])({url:"/restic/".concat(e,"/search/").concat(t),method:"get",params:o})}function p(e){return Object(r["a"])({url:"/restic/".concat(e,"/parms"),method:"get"})}function m(e){return Object(r["a"])({url:"/restic/".concat(e,"/parmsForMy"),method:"get"})}function f(e){return Object(r["a"])({url:"/restic/".concat(e,"/check"),method:"post"})}function b(e){return Object(r["a"])({url:"/restic/".concat(e,"/rebuild-index"),method:"post"})}function h(e){return Object(r["a"])({url:"/restic/".concat(e,"/prune"),method:"post"})}function y(e){return Object(r["a"])({url:"/restic/".concat(e,"/migrate"),method:"post"})}function g(e,t){return Object(r["a"])({url:"/restic/".concat(e,"/forget"),method:"post",params:{snapshotid:t}})}function k(e,t){return Object(r["a"])({url:"/restic/".concat(e,"/unlock"),method:"post",params:{all:t}})}function w(e,t){return Object(r["a"])({url:"/operation/last/".concat(t,"/").concat(e),method:"get"})}},"7db0":function(e,t,o){"use strict";var r=o("23e7"),a=o("b727").find,n=o("44d2"),s=o("ae40"),i="find",c=!0,l=s(i);i in[]&&Array(1)[i]((function(){c=!1})),r({target:"Array",proto:!0,forced:c||!l},{find:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),n(i)},"9cbb":function(e,t,o){"use strict";o.d(t,"e",(function(){return r})),o.d(t,"a",(function(){return a})),o.d(t,"d",(function(){return n})),o.d(t,"b",(function(){return s})),o.d(t,"c",(function(){return i}));var r=[{code:1,name:"S3",tips:"Minio"},{code:3,name:"Sftp",tips:"Not recommended"},{code:4,name:"Local",tips:"Recommended for testing"},{code:5,name:"Rest",tips:"Recommended"}],a=[{code:"last",name:"Count",tips:"Count"},{code:"hourly",name:"Hourly",tips:"Hourly"},{code:"daily",name:"Daily",tips:"Daily"},{code:"weekly",name:"Weekly",tips:"Weekly"},{code:"monthly",name:"Monthly",tips:"Monthly"},{code:"yearly",name:"Yearly",tips:"Yearly"}],n=[{code:1,name:"Fetching",color:"info"},{code:2,name:"Normal",color:"success"},{code:3,name:"Error",color:"danger"}],s=[{code:1,name:"Info",color:"info"},{code:2,name:"Warning",color:"warning"},{code:3,name:"Success",color:"success"},{code:4,name:"Error",color:"error"}],i=[{code:0,name:"Auto",color:"success"},{code:1,name:"Off",color:"info"},{code:2,name:"Maximum",color:"warning"}]},aced:function(e,t,o){"use strict";o("e688")},e688:function(e,t,o){},fe7f:function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"app-container"},[o("div",{staticClass:"handle-search"},[o("el-form",{attrs:{model:e.listQuery,inline:""},nativeOn:{submit:function(e){e.preventDefault()}}},[o("el-form-item",{attrs:{label:"Name"}},[o("el-input",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{placeholder:"name",clearable:""},model:{value:e.listQuery.name,callback:function(t){e.$set(e.listQuery,"name",t)},expression:"listQuery.name"}})],1),o("el-form-item",{attrs:{label:e._f("i18n")("type")}},[o("el-select",{staticClass:"handle-select mr5",attrs:{placeholder:"Please select"},model:{value:e.listQuery.type,callback:function(t){e.$set(e.listQuery,"type",t)},expression:"listQuery.type"}},e._l([{code:"",name:"All"}].concat(e.typeList),(function(e,t){return o("el-option",{key:t,attrs:{label:e.name,value:e.code}})})),1)],1),o("el-form-item",[o("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.getList}},[e._v("Search")])],1)],1)],1),o("div",{staticClass:"handle-box"},[o("el-button",{staticClass:"mr5",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("Create")])],1),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.list,border:"",fit:"","highlight-current-row":"","empty-text":"No data available"}},[o("el-table-column",{attrs:{align:"center",label:e._f("i18n")("ID"),width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.id))])]}}])}),o("el-table-column",{attrs:{prop:"name",align:"center",label:"Name"}}),o("el-table-column",{attrs:{prop:"createdAt",align:"center",formatter:e.dateFormat,label:"Creation Time"}}),o("el-table-column",{attrs:{prop:"endPoint",align:"left",label:"Server"}}),o("el-table-column",{attrs:{"class-name":"status-col",label:"Storage Type",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[e._v(" "+e._s(e.formatType(o.type).name)+" ")]}}])}),o("el-table-column",{attrs:{"class-name":"status-col",label:"Compression Mode",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[o("el-tag",{attrs:{type:e.formatCompression(r.compression).color}},[e._v(" "+e._s(e.formatCompression(r.compression).name)+" ")])]}}])}),o("el-table-column",{attrs:{"class-name":"status-col",label:"Connection Status",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.errmsg?o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:r.errmsg,placement:"bottom"}},[o("el-tag",{attrs:{type:e.formatStatus(r.status).color}},[e._v(" "+e._s(e.formatStatus(r.status).name)+" ")])],1):o("el-tag",{attrs:{type:e.formatStatus(r.status).color}},[e._v(" "+e._s(e.formatStatus(r.status).name)+" ")])]}}])}),o("el-table-column",{attrs:{align:"center",label:"Actions"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[o("el-dropdown",{attrs:{trigger:"click","hide-on-click":""},on:{command:e.handleCmd}},[o("span",{staticClass:"el-dropdown-link"},[e._v(" Actions"),o("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",{attrs:{icon:"el-icon-video-camera",command:{cmd:"restore",data:r.id}}},[e._v("Restore ")]),o("el-dropdown-item",{attrs:{icon:"el-icon-setting",command:{cmd:"oper",data:r.id}}},[e._v("Maintenance ")]),o("el-dropdown-item",{attrs:{icon:"el-icon-video-camera",command:{cmd:"snap",data:r.id}}},[e._v("Snapshot ")]),o("el-dropdown-item",{attrs:{icon:"el-icon-video-camera",command:{cmd:"edit",data:r}}},[e._v("Edit ")]),o("el-dropdown-item",{attrs:{icon:"el-icon-delete",command:{cmd:"del",data:r.id}}},[e._v("Delete ")])],1)],1)]}}])})],1),o("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,top:"5vh"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[o("el-form",{ref:"dataForm",attrs:{rules:e.rules,model:e.temp,"label-position":"left","label-width":"220px"}},[o("el-form-item",{attrs:{label:"Name",prop:"name"}},[o("el-input",{attrs:{clearable:""},model:{value:e.temp.name,callback:function(t){e.$set(e.temp,"name",t)},expression:"temp.name"}})],1),o("el-form-item",{attrs:{label:"Storage Type",prop:"type"}},[o("el-select",{attrs:{placeholder:"Please select"},on:{change:this.onTypeChange},model:{value:e.temp.type,callback:function(t){e.$set(e.temp,"type",t)},expression:"temp.type"}},e._l(e.typeList,(function(e){return o("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1),o("span",{staticClass:"repo-type-tips"},[e._v(e._s(e.formatType(e.temp.type).tips))])],1),o("el-form-item",{attrs:{label:"Endpoint",prop:"endPoint"}},[o("el-input",{attrs:{placeholder:e.endPointPlaceholder,clearable:""},model:{value:e.temp.endPoint,callback:function(t){e.$set(e.temp,"endPoint",t)},expression:"temp.endPoint"}})],1),1===e.temp.type||2===e.temp.type?o("el-form-item",{attrs:{label:"Region",prop:"region"}},[o("el-input",{attrs:{clearable:""},model:{value:e.temp.region,callback:function(t){e.$set(e.temp,"region",t)},expression:"temp.region"}})],1):e._e(),1===e.temp.type||2===e.temp.type||6===e.temp.type?o("el-form-item",{attrs:{label:"Bucket",prop:"bucket"}},[o("el-input",{attrs:{clearable:""},model:{value:e.temp.bucket,callback:function(t){e.$set(e.temp,"bucket",t)},expression:"temp.bucket"}})],1):e._e(),6===e.temp.type?o("el-form-item",{attrs:{label:"Access Key",prop:"keyId"}},[o("el-input",{attrs:{clearable:""},model:{value:e.temp.keyId,callback:function(t){e.$set(e.temp,"keyId",t)},expression:"temp.keyId"}})],1):e._e(),6===e.temp.type?o("el-form-item",{attrs:{label:"Secret Key",prop:"secret"}},[o("el-input",{attrs:{type:"password","show-password":"",clearable:""},model:{value:e.temp.secret,callback:function(t){e.$set(e.temp,"secret",t)},expression:"temp.secret"}})],1):e._e(),1===e.temp.type||2===e.temp.type?o("el-form-item",{attrs:{label:"AWS_ACCESS_KEY_ID",prop:"keyId"}},[o("el-input",{attrs:{clearable:""},model:{value:e.temp.keyId,callback:function(t){e.$set(e.temp,"keyId",t)},expression:"temp.keyId"}})],1):e._e(),1===e.temp.type||2===e.temp.type?o("el-form-item",{attrs:{label:"AWS_SECRET_ACCESS_KEY",prop:"secret"}},[o("el-input",{attrs:{type:"password","show-password":"",clearable:""},model:{value:e.temp.secret,callback:function(t){e.$set(e.temp,"secret",t)},expression:"temp.secret"}})],1):e._e(),7===e.temp.type?o("el-form-item",{attrs:{label:"SecretID",prop:"keyId"}},[o("el-input",{attrs:{clearable:""},model:{value:e.temp.keyId,callback:function(t){e.$set(e.temp,"keyId",t)},expression:"temp.keyId"}})],1):e._e(),7===e.temp.type?o("el-form-item",{attrs:{label:"SecretKey",prop:"secret"}},[o("el-input",{attrs:{type:"password","show-password":"",clearable:""},model:{value:e.temp.secret,callback:function(t){e.$set(e.temp,"secret",t)},expression:"temp.secret"}})],1):e._e(),5===e.temp.type?o("el-form-item",{attrs:{label:"Account",prop:"keyId"}},[o("el-input",{attrs:{clearable:""},model:{value:e.temp.keyId,callback:function(t){e.$set(e.temp,"keyId",t)},expression:"temp.keyId"}})],1):e._e(),5===e.temp.type?o("el-form-item",{attrs:{label:"Password",prop:"secret"}},[o("el-input",{attrs:{type:"password","show-password":"",clearable:""},model:{value:e.temp.secret,callback:function(t){e.$set(e.temp,"secret",t)},expression:"temp.secret"}})],1):e._e(),"create"===e.dialogStatus?o("el-form-item",{attrs:{label:"Repository Password",prop:"password"}},[o("el-input",{attrs:{"show-password":"",clearable:"",type:"password"},model:{value:e.temp.password,callback:function(t){e.$set(e.temp,"password",t)},expression:"temp.password"}})],1):e._e(),"create"===e.dialogStatus?o("el-form-item",{attrs:{label:"Confirm Password",prop:"confirmPassword"}},[o("el-input",{attrs:{"show-password":"",clearable:"",type:"password"},model:{value:e.temp.confirmPassword,callback:function(t){e.$set(e.temp,"confirmPassword",t)},expression:"temp.confirmPassword"}})],1):e._e(),"create"===e.dialogStatus?o("el-form-item",{attrs:{label:"Compression Mode",prop:"type"}},[o("el-select",{attrs:{placeholder:"Please select"},model:{value:e.temp.compression,callback:function(t){e.$set(e.temp,"compression",t)},expression:"temp.compression"}},e._l(e.compressionList,(function(e){return o("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1):e._e(),o("el-form-item",{attrs:{label:"PackSize",prop:"PackSize"}},[o("el-input",{attrs:{clearable:""},model:{value:e.temp.packSize,callback:function(t){e.$set(e.temp,"packSize",t)},expression:"temp.packSize"}},[o("template",{slot:"append"},[e._v("MiB")])],2)],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(" Cancel ")]),o("el-button",{attrs:{type:"primary",loading:e.buttonLoading},on:{click:function(t){"create"===e.dialogStatus?e.createData():e.updateData()}}},[e._v(" Confirm ")])],1)],1)],1)},a=[],n=(o("7db0"),o("a9e3"),o("d3b7"),o("3ffe")),s=o("ed08"),i=o("9cbb"),c={name:"RepositoryList",data:function(){var e=this,t=function(t,o,r){""===o?r(new Error("This item is required")):o!==e.temp.password?r(new Error("The two passwords do not match")):r()};return{typeList:i["e"],statusList:i["d"],compressionList:i["c"],list:[],listLoading:!1,listQuery:{name:"",type:"",pageNum:1,pageSize:10},textMap:{update:"Modify Repository",create:"Create Repository"},dialogStatus:"",dialogFormVisible:!1,buttonLoading:!1,endPointPlaceholder:"",temp:{id:0,name:"",type:4,endPoint:"",region:"",bucket:"",keyId:"",secret:"",projectId:"",accountName:"",accountKey:"",accountId:"",password:"",confirmPassword:"",compression:0,packSize:16},rules:{name:[{required:!0,message:"This field is required",trigger:"blur"}],type:[{required:!0,message:"This field is required",trigger:"change"}],endPoint:[{required:!0,message:"This field is required",trigger:"blur"}],region:[{required:!1,message:"This field is required",trigger:"blur"}],bucket:[{required:!0,message:"This field is required",trigger:"blur"}],keyId:[{required:!0,message:"This field is required",trigger:"blur"}],secret:[{required:!0,message:"This field is required",trigger:"blur"}],password:[{required:!0,message:"This field is required",trigger:"blur"}],confirmPassword:[{required:!0,validator:t,trigger:"blur"}]}}},created:function(){this.getList()},methods:{dateFormat:function(e,t,o,r){return Object(s["a"])(o,"yyyy-MM-dd hh:mm")},resetTemp:function(){this.temp={id:0,name:"",type:4,endPoint:"",region:"",bucket:"",keyId:"",secret:"",projectId:"",accountName:"",accountKey:"",accountId:"",password:"",user:"",authpwd:"",compression:0,packSize:16},this.endPointPlaceholder=""},onTypeChange:function(e){switch(this.endPointPlaceholder="",e){case 1:this.endPointPlaceholder="http(s)://s3host:port";break;case 3:this.endPointPlaceholder="user@host:/data/my_backup_repo";break;case 4:this.endPointPlaceholder="/data/my_backup_repo";break;case 5:this.endPointPlaceholder="http(s)://host:8000/my_backup_repo/";break}},handleCmd:function(e){var t=e.cmd,o=e.data;switch(t){case"snap":this.$router.push("/repository/snapshot/"+o);break;case"restore":this.$router.push("/repository/restore/"+o);break;case"del":this.handleDel(o);break;case"edit":this.handleEdit(o);break;case"oper":this.$router.push("/repository/operation/"+o);break}},handleAdd:function(){var e=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick((function(){e.$refs["dataForm"].clearValidate()}))},createData:function(){var e=this;this.$refs["dataForm"].validate((function(t){t&&(e.buttonLoading=!0,e.temp.packSize=Number(e.temp.packSize),Object(n["b"])(e.temp).then((function(){e.$notify.success("Created successfully!"),e.buttonLoading=!1,e.dialogFormVisible=!1,e.getList()})).catch((function(){e.buttonLoading=!1})))}))},handleEdit:function(e){var t=this;this.temp=Object.assign({},e),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick((function(){t.$refs["dataForm"].clearValidate()}))},updateData:function(){var e=this;this.$refs["dataForm"].validate((function(t){t&&(e.buttonLoading=!0,e.temp.packSize=Number(e.temp.packSize),Object(n["q"])(e.temp).then((function(){e.$notify.success("Modification succeeded!"),e.buttonLoading=!1,e.dialogFormVisible=!1,e.getList()})).catch((function(){e.buttonLoading=!1})))}))},handleDel:function(e){var t=this;this.$confirm("Are you sure you want to delete this repository? ","Delete",{type:"warning"}).then((function(){t.listLoading=!0,Object(n["c"])(e).then((function(){t.$notify.success("Delete successfully!"),t.getList()})).finally((function(){t.listLoading=!1}))})).catch((function(){t.$notify.info("Cancel deletion")}))},formatType:function(e){return this.typeList.find((function(t){return t.code===e}))},formatCompression:function(e){return this.compressionList.find((function(t){return t.code===e}))},formatStatus:function(e){return this.statusList.find((function(t){return t.code===e}))},getList:function(){var e=this;this.listLoading=!0,Object(n["g"])(this.listQuery).then((function(t){e.list=t.data})).finally((function(){e.listLoading=!1}))}}},l=c,d=(o("aced"),o("2877")),u=Object(d["a"])(l,r,a,!1,null,"e7d8fef2",null);t["default"]=u.exports}}]);